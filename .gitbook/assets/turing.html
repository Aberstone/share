<html>

<head>
    <title>图灵机演示</title>
    <meta charset=utf-8;>

    <script language="javascript">
        var a_canvas; var a_context; var Backgd = "#ea1"; var Foregd = "#210"; var Backgd1 = "#fdd"; var Backgd2 = "#840"; var Backgd3 = "#ddd"; var Backgd4 = "#eef"; var delta = 40; var halfa = 20; var bianw = 20; var bianh = 20; var yanshi3 = 2; var cell = new Array(300); var pointcell = 100; var inistate = ""; var state = ""; var chushicode = 0; var zdzt = false; var zdmingl = false; var lbx = 91 * delta; var rbx = lbx + 24 * delta + 2 * bianw; var dx = 10; var rKeydown = false; var lKeydown = false; var repeat = 0; var timedelta = 300; var yanshi = 1; var rule_1 = new Array(); var rule_2 = new Array(); var rule_3 = new Array(); var rule_4 = new Array(); var rule_5 = new Array(); var rule_n = 21; var rule_name = ""; var current_rule = -1; var rule1_n = 21; var rule1_name = "二进制码的展开"; var rule1_1 = new Array("B", "B", "B", "B", "B", "B", "B", "0", "0", "0", "0", "0", "0", "0", "1", "1", "1", "1", "1", "1", "1"); var rule1_2 = new Array("q1", "q2", "q3", "q4", "q5", "q6", "q7", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "q1", "q2", "q3", "q4", "q5", "q6", "q7"); var rule1_3 = new Array("B", "B", "1", "B", "B", "B", "B", "0", "0", "0", "0", "1", "0", "B", "1", "1", "1", "1", "0", "1", "1"); var rule1_4 = new Array("q7", "q3", "q4", "q5", "Er", "q1", "St", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "q2", "q2", "q3", "q4", "q6", "q6", "Er"); var rule1_5 = new Array("L", "R", "L", "L", "H", "R", "H", "R", "R", "R", "L", "L", "L", "L", "R", "R", "R", "L", "L", "L", "H"); var rule2_n = 21; var rule2_name = "求２的ｘ次方"; var rule2_1 = new Array("B", "B", "B", "B", "B", "B", "B", "0", "0", "0", "0", "0", "0", "0", "1", "1", "1", "1", "1", "1", "1"); var rule2_2 = new Array("q1", "q2", "q3", "q4", "q5", "q6", "q7", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "q1", "q2", "q3", "q4", "q5", "q6", "q7"); var rule2_3 = new Array("1", "B", "0", "B", "B", "B", "B", "0", "0", "0", "0", "1", "0", "B", "1", "1", "1", "1", "0", "1", "1"); var rule2_4 = new Array("q7", "q3", "q4", "q5", "Er", "q1", "St", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "q2", "q2", "Er", "Er", "q6", "q6", "Er"); var rule2_5 = new Array("L", "R", "L", "L", "H", "R", "H", "R", "R", "R", "L", "L", "L", "L", "R", "R", "H", "H", "L", "L", "H"); var rule3_n = 53; var rule3_name = "通用图灵机示1"; var rule3_1 = new Array("B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "L", "R", "H", "b", "-", "#", "B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "b", "-", "#", "L", "R", "H", "0", "1", "B", "B", "1", "1", "B", "B", "0", "1", "1", "0", "B", "1", "0", "0", "1", "B", "1", "0", "0"); var rule3_2 = new Array("q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "qa", "qa", "qa", "qb", "qb", "qc", "qc", "qd", "qd", "qd", "qe", "qe", "qe", "qf", "qf", "qg", "qg", "qg", "qh", "qh", "qi"); var rule3_3 = new Array("B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "L", "R", "H", "b", "-", "#", "B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "b", "-", "#", "L", "R", "H", "0", "1", "B", "1", "1", "1", "B", "B", "B", "1", "1", "0", "B", "0", "1", "0", "1", "B", "0", "1", "B"); var rule3_4 = new Array("q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q2", "q1", "q1", "q1", "q1", "qf", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "qa", "qa", "qb", "qc", "qb", "qc", "qd", "qd", "qd", "qe", "qe", "qe", "q1", "qg", "qh", "qa", "qa", "qi", "qa", "qh", "St"); var rule3_5 = new Array("R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "R", "L", "R", "R", "R", "R", "R", "R", "R", "R", "L", "L", "L", "L", "R", "L", "L", "H"); var rule4_n = 21; var rule4_name = "二进制码的展开"; var rule4_1 = new Array("0", "1", "B", "B", "1", "1", "B", "B", "0", "1", "1", "0", "B", "1", "0", "0", "1", "B", "1", "0", "0"); var rule4_2 = new Array("q1", "q1", "q1", "q2", "q2", "q3", "q3", "q4", "q4", "q4", "q5", "q5", "q5", "q6", "q6", "q7", "q7", "q7", "q8", "q8", "q9"); var rule4_3 = new Array("0", "1", "B", "1", "1", "1", "B", "B", "B", "1", "1", "0", "B", "0", "1", "0", "1", "B", "0", "1", "B"); var rule4_4 = new Array("q1", "q1", "q2", "q3", "q2", "q3", "q4", "q4", "q4", "q5", "q5", "q5", "q6", "q7", "q8", "q1", "q1", "q9", "q1", "q8", "St"); var rule4_5 = new Array("L", "L", "L", "R", "L", "R", "R", "R", "R", "R", "R", "R", "L", "L", "L", "L", "L", "R", "L", "L", "H"); var rule5_n = 25; var rule5_name = "求２的ｘ次方"; var rule5_1 = new Array("0", "1", "B", "B", "0", "0", "B", "B", "0", "1", "1", "0", "B", "1", "0", "0", "1", "B", "1", "0", "0", "B", "0", "0", "B"); var rule5_2 = new Array("q1", "q1", "q1", "q2", "q2", "q3", "q3", "q4", "q4", "q4", "q5", "q5", "q5", "q6", "q6", "q7", "q7", "q7", "q8", "q8", "q9", "q0", "q0", "qt", "qt"); var rule5_3 = new Array("0", "1", "B", "0", "0", "0", "B", "B", "B", "1", "1", "0", "B", "0", "1", "0", "1", "B", "0", "1", "B", "B", "0", "0", "1"); var rule5_4 = new Array("q1", "q1", "q2", "q3", "q2", "q3", "q4", "q4", "q4", "q5", "q5", "q5", "q6", "q7", "q8", "q1", "q1", "q9", "q1", "q8", "q0", "q0", "qt", "qt", "St"); var rule5_5 = new Array("L", "L", "L", "R", "L", "R", "R", "R", "R", "R", "R", "R", "L", "L", "L", "L", "L", "R", "L", "L", "L", "L", "L", "L", "H"); var rule6_n = 25; var rule6_name = "求２的ｘ次方"; var rule6_1 = new Array("0", "1", "B", "B", "0", "0", "B", "B", "0", "1", "1", "0", "B", "1", "0", "0", "1", "B", "1", "0", "0", "B", "0", "0", "B"); var rule6_2 = new Array("qa", "qa", "qa", "qb", "qb", "qc", "qc", "qd", "qd", "qd", "qe", "qe", "qe", "qf", "qf", "qg", "qg", "qg", "qh", "qh", "qi", "qj", "qj", "qk", "qk"); var rule6_3 = new Array("0", "1", "B", "0", "0", "0", "B", "B", "B", "1", "1", "0", "B", "0", "1", "0", "1", "B", "0", "1", "B", "B", "0", "0", "1"); var rule6_4 = new Array("qa", "qa", "qb", "qc", "qb", "qc", "qd", "qd", "qd", "qe", "qe", "qe", "qf", "qg", "qh", "qa", "qa", "qi", "qa", "qh", "qj", "qj", "qk", "qk", "St"); var rule6_5 = new Array("L", "L", "L", "R", "L", "R", "R", "R", "R", "R", "R", "R", "L", "L", "L", "L", "L", "R", "L", "L", "L", "L", "L", "L", "H"); var rule7_n = 57; var rule7_name = "通用图灵机示2"; var rule7_1 = new Array("B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "L", "R", "H", "b", "-", "#", "B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "b", "-", "#", "L", "R", "H", "0", "1", "B", "B", "0", "0", "B", "B", "0", "1", "1", "0", "B", "1", "0", "0", "1", "B", "1", "0", "0", "B", "0", "0", "B"); var rule7_2 = new Array("q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "qa", "qa", "qa", "qb", "qb", "qc", "qc", "qd", "qd", "qd", "qe", "qe", "qe", "qf", "qf", "qg", "qg", "qg", "qh", "qh", "qi", "qj", "qj", "qk", "qk"); var rule7_3 = new Array("B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "L", "R", "H", "b", "-", "#", "B", "1", "0", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "b", "-", "#", "L", "R", "H", "0", "1", "B", "0", "0", "0", "B", "B", "B", "1", "1", "0", "B", "0", "1", "0", "1", "B", "0", "1", "B", "B", "0", "0", "1"); var rule7_4 = new Array("q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q1", "q2", "q1", "q1", "q1", "q1", "qf", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "q2", "qa", "qa", "qb", "qc", "qb", "qc", "qd", "qd", "qd", "qe", "qe", "qe", "q1", "qg", "qh", "qa", "qa", "qi", "qa", "qh", "qj", "qj", "qk", "qk", "St"); var rule7_5 = new Array("R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "R", "L", "R", "R", "R", "R", "R", "R", "R", "R", "L", "L", "L", "L", "R", "L", "L", "L", "L", "L", "L", "H"); function ini() { a_canvas = document.getElementById("a"); a_canvas.width = 24 * delta + 2 * bianw; a_canvas.height = 13 * delta + 2 * bianh; a_context = a_canvas.getContext("2d"); a_context.fillStyle = Backgd; a_context.fillRect(0, 0, 24 * delta + 2 * bianw, 13 * delta + 2 * bianh); a_context.beginPath(); a_context.lineWidth = 3; a_context.strokeStyle = Backgd1; a_context.moveTo(24 * delta + 2 * bianw, 1.5); a_context.lineTo(1.5, 1.5); a_context.lineTo(1.5, 13 * delta + 2 * bianh); a_context.stroke(); a_context.beginPath(); a_context.strokeStyle = Backgd2; a_context.moveTo(24 * delta + 2 * bianw - 1.5, 0); a_context.lineTo(24 * delta + 2 * bianw - 1.5, 13 * delta + 2 * bianh - 1.5); a_context.lineTo(0, 13 * delta + 2 * bianh - 1.5); a_context.stroke(); a_context.strokeStyle = Backgd2; a_context.fillStyle = Backgd3; a_context.fillRect(0, 1.5 * delta + bianh, 24 * delta + 2 * bianh + 4, 4.5 * delta - bianh); a_context.strokeStyle = Backgd2; a_context.fillStyle = Backgd3; a_context.fillRect(bianw, 7 * delta + bianh, 24 * delta, 6 * delta); a_context.lineWidth = 3; a_context.beginPath(); a_context.strokeStyle = Backgd2; a_context.moveTo(0, 1.5 * delta + bianh); a_context.lineTo(24 * delta + 2 * bianw, 1.5 * delta + bianh); a_context.stroke(); a_context.beginPath(); a_context.strokeStyle = Backgd2; a_context.moveTo(24 * delta + bianw, 7 * delta + bianh); a_context.lineTo(bianw, 7 * delta + bianh); a_context.lineTo(bianw, 13.5 * delta); a_context.stroke(); a_context.lineWidth = 1; a_context.fillStyle = Foregd; a_context.font = "bold " + delta + "px 楷体_GB2312"; a_context.textBaseline = "top"; a_context.fillText("图灵机演示", 6 * delta, bianh); a_context.font = 2 * delta / 3 + "px 楷体_GB2312"; a_context.fillText("", 18 * delta, bianh + 8); a_drawimage(bianw + 24 * delta, 5.5 * delta + 3, 8); a_drawimage(4, 5.5 * delta + 3, 9); a_drawimage(bianw + 11 * delta, 6 * delta + bianh - 4, 4); a_drawimage(bianw + 12 * delta, 6 * delta + bianh - 4, 5); a_drawimage(bianw + 13 * delta, 6 * delta + bianh - 4, 6); a_drawimage(bianw + 17 * delta, 6 * delta + bianh - 4, 4); a_drawimage(bianw + 18 * delta, 6 * delta + bianh - 4, 7); a_drawimage(bianw + 20 * delta, 6 * delta + bianh - 4, 0); a_drawimage(bianw + 21 * delta, 6 * delta + bianh - 4, 1); a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); a_drawimage(bianw + 23 * delta + 3, 6 * delta + bianh - 4, 10); a_context.font = "bold " + 2 * delta / 3 + "px 仿宋_GB2312"; a_context.fillStyle = Foregd; a_context.fillText("演示：", bianw + 9 * delta, bianh + 6 * delta - 2); a_context.fillText("初始字：", bianw + 14.5 * delta, bianh + 6 * delta - 2); a_context.font = 1 * delta / 2 + "px Arial"; for (var i = 0; i < 300; i += 1) { cell[i] = ""; } state = ""; drawbelt(); a_canvas.addEventListener('mousedown', CursorDown, false); a_canvas.addEventListener('mouseup', CursorUp, false); document.onkeyup = KeyupCheck; document.onkeydown = KeydownCheck; } function drawbelt() { for (var i = 0; i < 300; i += 1) { var cellx = bianw + i * delta; if (cellx > (lbx - delta) && cellx < rbx) drawcell(i); } drawhead(); var crule = getrule(); if (crule > -1) drawrulei(crule, 1); } function resethead() { var orgx = bianw + pointcell * delta - lbx; var orgy = bianh + 3 * delta; a_context.strokeStyle = Foregd; a_context.fillStyle = Backgd3; a_context.fillRect(orgx - 1, orgy + 1, delta + 2, 2 * delta + 1); } function drawhead() { var orgx = bianw + pointcell * delta - lbx; var orgy = bianh + 3 * delta; a_context.strokeStyle = Foregd; a_context.fillStyle = Backgd3; a_context.fillRect(orgx - 1, orgy + 1, delta + 2, 2 * delta + 1); a_context.fillStyle = Backgd4; a_context.lineWidth = 1; a_context.beginPath(); a_context.moveTo(orgx + delta / 2, orgy + 1); a_context.lineTo(orgx, orgy + delta); a_context.lineTo(orgx, orgy + 2 * delta); a_context.lineTo(orgx + delta, orgy + 2 * delta); a_context.lineTo(orgx + delta, orgy + delta); a_context.lineTo(orgx + delta / 2, orgy + 1); a_context.fill(); a_context.stroke(); a_context.font = 1 * delta / 2 + "px Arial"; a_context.fillStyle = Foregd; var ddx = delta / 4; if (state.length == 2) ddx = delta / 6; a_context.fillText(state, orgx + ddx, orgy + delta + 12); } function drawcell(i) { var orgx = bianw + i * delta - lbx; var orgy = bianh + 2 * delta; var strs = cell[i]; a_context.strokeStyle = Foregd; a_context.fillStyle = Backgd4; a_context.lineWidth = 1; a_context.beginPath(); a_context.moveTo(orgx, orgy); a_context.lineTo(orgx + delta, orgy); a_context.lineTo(orgx + delta, orgy + delta); a_context.lineTo(orgx, orgy + delta); a_context.lineTo(orgx, orgy); a_context.fill(); a_context.stroke(); a_context.font = 1 * delta / 2 + "px Arial"; a_context.fillStyle = Foregd; var ddx = delta / 3; if (strs.length == 2) ddx = delta / 6; a_context.fillText(strs, orgx + ddx, orgy + 12); } function a_drawimage(i, j, type) { var bg = Backgd; var fr = Foregd; var nei = "#ff0"; var cell_x = i; var cell_y = j; var qt = delta; a_context.fillStyle = bg; a_context.strokeStyle = fr; if (type < 8 || type > 9) a_context.fillRect(cell_x - 2, cell_y - 2, qt + 4, qt + 4); a_context.lineWidth = 2; a_context.strokeStyle = fr; a_context.fillStyle = nei; qt = delta - 10; if (type == 0) { a_context.beginPath(); a_context.moveTo(cell_x + 3, cell_y); a_context.lineTo(cell_x + 3, cell_y + qt); a_context.stroke(); a_context.beginPath(); a_context.moveTo(cell_x + 1, cell_y + qt / 2); a_context.lineTo(cell_x - 1 + qt, cell_y + 1); a_context.lineTo(cell_x - 1 + qt, cell_y - 1 + qt); a_context.lineTo(cell_x + 1, cell_y + qt / 2); a_context.fill(); a_context.moveTo(cell_x + 1, cell_y); a_context.lineTo(cell_x + 1, cell_y + qt); a_context.stroke(); } else if (type == 1) { a_context.beginPath(); a_context.moveTo(cell_x + 1, cell_y); a_context.lineTo(cell_x - 1 + qt, cell_y + qt / 2); a_context.lineTo(cell_x + 1, cell_y + qt); a_context.lineTo(cell_x + 1, cell_y); a_context.fill(); a_context.stroke(); } else if (type == 2) { a_context.beginPath(); a_context.moveTo(cell_x + 1 + 3 * qt / 8, cell_y); a_context.lineTo(cell_x - 1 + qt, cell_y + qt / 2); a_context.lineTo(cell_x + 1 + 3 * qt / 8, cell_y + qt); a_context.lineTo(cell_x + 1 + 3 * qt / 8, cell_y); a_context.fill(); a_context.stroke(); a_context.beginPath(); a_context.moveTo(cell_x + 1, cell_y); a_context.lineTo(cell_x - 1 + qt - 3 * qt / 8, cell_y + qt / 2); a_context.lineTo(cell_x + 1, cell_y + qt); a_context.lineTo(cell_x + 1, cell_y); a_context.fill(); a_context.stroke(); } else if (type == 3) { a_context.beginPath(); a_context.moveTo(cell_x + 1 + qt / 8, cell_y); a_context.lineTo(cell_x + 1 + 3 * qt / 8, cell_y); a_context.lineTo(cell_x + 1 + 3 * qt / 8, cell_y + qt); a_context.lineTo(cell_x + 1 + qt / 8, cell_y + qt); a_context.lineTo(cell_x + 1 + qt / 8, cell_y); a_context.moveTo(cell_x - 1 + 5 * qt / 8, cell_y); a_context.lineTo(cell_x - 1 + 7 * qt / 8, cell_y); a_context.lineTo(cell_x - 1 + 7 * qt / 8, cell_y + qt); a_context.lineTo(cell_x - 1 + 5 * qt / 8, cell_y + qt); a_context.lineTo(cell_x - 1 + 5 * qt / 8, cell_y); a_context.fill(); a_context.stroke(); } else if (type == 4) { a_context.beginPath(); a_context.arc(cell_x + qt / 2, cell_y + qt / 2, qt / 2 - 1, 0, Math.PI * 2, false); a_context.fill(); a_context.stroke(); a_context.beginPath(); a_context.moveTo(cell_x + qt / 2, cell_y + qt / 4); a_context.lineTo(cell_x + qt / 2, cell_y + 3 * qt / 4); a_context.stroke(); } else if (type == 5) { a_context.beginPath(); a_context.arc(cell_x + qt / 2, cell_y + qt / 2, qt / 2 - 1, 0, Math.PI * 2, false); a_context.fill(); a_context.stroke(); a_context.beginPath(); a_context.moveTo(cell_x + 2 * qt / 5, cell_y + qt / 4); a_context.lineTo(cell_x + 2 * qt / 5, cell_y + 3 * qt / 4); a_context.moveTo(cell_x + 3 * qt / 5, cell_y + qt / 4); a_context.lineTo(cell_x + 3 * qt / 5, cell_y + 3 * qt / 4); a_context.stroke(); } else if (type == 6) { a_context.beginPath(); a_context.arc(cell_x + qt / 2, cell_y + qt / 2, qt / 2 - 1, 0, Math.PI * 2, false); a_context.fill(); a_context.stroke(); a_context.beginPath(); a_context.moveTo(cell_x + qt / 3, cell_y + qt / 4); a_context.lineTo(cell_x + qt / 3, cell_y + 3 * qt / 4); a_context.moveTo(cell_x + qt / 2, cell_y + qt / 4); a_context.lineTo(cell_x + qt / 2, cell_y + 3 * qt / 4); a_context.moveTo(cell_x + 2 * qt / 3, cell_y + qt / 4); a_context.lineTo(cell_x + 2 * qt / 3, cell_y + 3 * qt / 4); a_context.stroke(); } else if (type == 7) { a_context.beginPath(); a_context.arc(cell_x + qt / 2, cell_y + qt / 2, qt / 2 - 1, 0, Math.PI * 2, false); a_context.fill(); a_context.stroke(); a_context.beginPath(); a_context.moveTo(cell_x + qt / 2, cell_y + qt / 4); a_context.lineTo(cell_x + qt / 2, cell_y + 3 * qt / 4); a_context.moveTo(cell_x + qt / 4, cell_y + qt / 2); a_context.lineTo(cell_x + 3 * qt / 4, cell_y + qt / 2); a_context.stroke(); } else if (type == 8) { a_context.beginPath(); a_context.moveTo(cell_x + 1, cell_y); a_context.lineTo(cell_x - 1 + qt / 2, cell_y + qt / 4); a_context.lineTo(cell_x + 1, cell_y + qt / 2); a_context.lineTo(cell_x + 1, cell_y); a_context.stroke(); } else if (type == 9) { a_context.beginPath(); a_context.moveTo(cell_x + qt / 2, cell_y); a_context.lineTo(cell_x + 1, cell_y + qt / 4); a_context.lineTo(cell_x + qt / 2, cell_y + qt / 2); a_context.lineTo(cell_x + qt / 2, cell_y); a_context.stroke(); } else if (type == 10) { a_context.beginPath(); a_context.moveTo(cell_x - 3 + qt, cell_y); a_context.lineTo(cell_x - 3 + qt, cell_y + qt); a_context.stroke(); a_context.beginPath(); a_context.moveTo(cell_x + 1, cell_y); a_context.lineTo(cell_x - 1 + qt, cell_y + qt / 2); a_context.lineTo(cell_x + 1, cell_y + qt); a_context.lineTo(cell_x + 1, cell_y); a_context.fill(); a_context.moveTo(cell_x - 1 + qt, cell_y); a_context.lineTo(cell_x - 1 + qt, cell_y + qt); a_context.stroke(); } } function CursorDown(e) { var x; var y; x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft; y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop; x -= a_canvas.offsetLeft; y -= a_canvas.offsetTop; x -= bianw; y -= bianh; var click_x = Math.floor(x / delta); var click_y = Math.floor(y / delta); if (click_x < 1 && click_y > 0 && click_y < 6) { lKeydown = true; zdleft(); } else if (click_x > 22 && click_y > 0 && click_y < 6) { rKeydown = true; zdright(); } } function CursorUp(e) { var x; var y; x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft; y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop; x -= a_canvas.offsetLeft; y -= a_canvas.offsetTop; x -= bianw; y -= bianh; var click_x = Math.floor(x / delta); var click_y = Math.floor(y / delta); rKeydown = false; lKeydown = false; if (click_x == 20 && click_y == 6) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); if (yanshi == 3) drawresult(); } tobegin(); } else if (click_x == 21 && click_y == 6) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } else gonext(); } else if (click_x == 22 && click_y == 6) { if (zdmingl) { timedelta = 300; zdmingl = false; zdzt = false; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } else { timedelta = 300; zdmingl = true; zdzt = true; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 3); tozd(); } } else if (click_x == 23 && click_y == 6) { if (zdmingl) { if (timedelta == 300) timedelta = 150; else if (timedelta == 150) timedelta = 0; else if (timedelta == 0) { timedelta = 300; if (yanshi == 3) { zdmingl = false; zdzt = false; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); drawresult(); } } } } else if (click_x == 11 && click_y == 6) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); chushicode = 1; drawiniz(chushicode); } drawrule4(); } else if (click_x == 12 && click_y == 6) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); chushicode = 1; drawiniz(chushicode); } drawrule2(); } else if (click_x == 13 && click_y == 6) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); chushicode = 1; drawiniz(chushicode); } drawrule3(); } else if (click_x == 17 && click_y == 6) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } chushicode = 1; drawiniz(chushicode); } else if (click_x == 18 && click_y == 6) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); chushicode = 1; } else chushicode++; drawiniz(chushicode); } else if (click_x < 1 && click_y > 0 && click_y < 6) { lKeydown = false; resethead(); lbx += dx; drawbelt(); rbx = lbx + 24 * delta + 2 * bianw; } else if (click_x > 22 && click_y > 0 && click_y < 6) { rKeydown = false; resethead(); lbx -= dx; drawbelt(); rbx = lbx + 24 * delta + 2 * bianw; } return; } function KeyupCheck(e) { var KeyID = (window.event) ? event.keyCode : e.keyCode; var keyname = ""; rKeydown = false; lKeydown = false; if (KeyID == 32) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } else { timedelta = 300; zdmingl = true; zdzt = true; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 3); tozd(); } } if (KeyID == 13) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } else gonext(); } else if (KeyID == 8) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } tobegin(); } else if (KeyID == 75) { if (zdmingl) { if (timedelta == 300) timedelta = 150; else if (timedelta == 150) timedelta = 0; else if (timedelta == 0) { timedelta = 300; if (yanshi == 3) { zdmingl = false; zdzt = false; rKeydown = false; lKeydown = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); drawresult(); } } } } else if (KeyID == 37) { lKeydown = false; resethead(); lbx += dx; drawbelt(); rbx = lbx + 24 * delta + 2 * bianw; } else if (KeyID == 39) { rKeydown = false; resethead(); lbx -= dx; drawbelt(); rbx = lbx + 24 * delta + 2 * bianw; } else if (KeyID == 38) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); chushicode = 1; } else chushicode++; drawiniz(chushicode); } else if (KeyID == 40) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } chushicode = 1; drawiniz(chushicode); } else if (KeyID == 49) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } drawrule4(); } else if (KeyID == 50) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } drawrule2(); } else if (KeyID == 51) { if (zdmingl) { zdmingl = false; zdzt = false; timedelta = 300; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } drawrule3(); } } function KeydownCheck(e) { var KeyID = (window.event) ? event.keyCode : e.keyCode; var keyname = ""; if (KeyID == 37) { lKeydown = true; zdleft(); } else if (KeyID == 39) { rKeydown = true; zdright(); } } function zdleft() { if (lKeydown) { resethead(); lbx += dx; rbx = lbx + 24 * delta + 2 * bianw; drawbelt(); setTimeout("zdleft()", 50); } } function zdright() { if (rKeydown) { resethead(); lbx -= dx; rbx = lbx + 24 * delta + 2 * bianw; drawbelt(); setTimeout("zdright()", 50); } } function drawresult() { resethead(); var crule = getrule(); if (crule > -1) { drawrulei(crule, 0); } cell[100] = ""; cell[99] = ""; cell[98] = ""; pointcell = 98; state = "St"; for (var i = 0; i < chushicode; i += 1) { pointcell--; if (yanshi3 == 1) cell[pointcell] = "1"; else cell[pointcell] = "0"; } if (yanshi3 == 2) { pointcell--; cell[pointcell] = "1"; } lbx = (pointcell - 3) * delta; if (yanshi3 == 1) pointcell = pointcell + chushicode + 1; if ((pointcell - 23) * delta > lbx) lbx = (pointcell - 23) * delta; rbx = lbx + 24 * delta + 2 * bianw; drawbelt(); } function drawiniz(code) { var crule = getrule(); if (crule > -1) { drawrulei(crule, 0); } for (var i = 0; i < 300; i += 1) { cell[i] = ""; } resethead(); lbx = 91 * delta; rbx = lbx + 24 * delta + 2 * bianw; pointcell = 100; state = inistate; var org = pointcell + 1; if (yanshi == 3) { cell[pointcell + 0] = "B"; if (yanshi3 == 1) for (var i = 0; i < rule4_n; i += 1) { cell[org + i * 7 + 1] = rule4_1[i]; if (rule4_1[i] == "B") cell[org + i * 7 + 1] = "b"; cell[org + i * 7 + 2] = rule4_2[i]; cell[org + i * 7 + 3] = "-"; cell[org + i * 7 + 4] = rule4_3[i]; if (rule4_3[i] == "B") cell[org + i * 7 + 4] = "b"; cell[org + i * 7 + 5] = rule4_4[i]; cell[org + i * 7 + 6] = rule4_5[i]; cell[org + i * 7] = "#"; if (i == rule1_n - 1) cell[org + i * 7 + 7] = "$"; } else if (yanshi3 == 2) for (var i = 0; i < rule5_n; i += 1) { cell[org + i * 7 + 1] = rule5_1[i]; if (rule5_1[i] == "B") cell[org + i * 7 + 1] = "b"; cell[org + i * 7 + 2] = rule5_2[i]; cell[org + i * 7 + 3] = "-"; cell[org + i * 7 + 4] = rule5_3[i]; if (rule5_3[i] == "B") cell[org + i * 7 + 4] = "b"; cell[org + i * 7 + 5] = rule5_4[i]; cell[org + i * 7 + 6] = rule5_5[i]; cell[org + i * 7] = "#"; if (i == rule1_n - 1) cell[org + i * 7 + 7] = "$"; } } while (code > 0) { var oldcode = code; code = Math.floor(code / 2); pointcell--; if (oldcode - 2 * code == 0) cell[pointcell] = "0"; else cell[pointcell] = "1"; } drawbelt(); } function drawrulei(i, col) { if (i < 35) { var k = 6; var y = Math.floor((i + 1) / k); var x = (i + 1) - k * y; a_context.fillStyle = Backgd3; a_context.fillRect(bianw + x * 4 * delta + 2, bianh + (7 + y) * delta + 2, 4 * delta - 2, delta - 2); a_context.font = 1 * delta / 2 + "px Arial"; if (yanshi == 3) a_context.font = 18 * delta / 40 + "px Arial"; a_context.fillStyle = Foregd; if (col == 1) a_context.fillStyle = "#e00"; var str = rule_1[i] + "," + rule_2[i] + ">" + rule_3[i] + "," + rule_4[i] + "," + rule_5[i] + ";"; a_context.fillText(str, bianw + x * 4 * delta + delta / 8, bianh + (7 + y) * delta + delta / 4); } } function drawrule() { zdzt = false; for (var i = 0; i < 300; i += 1) { cell[i] = ""; } resethead(); pointcell = 100; state = inistate; lbx = 91 * delta; rbx = lbx + 24 * delta + 2 * bianw; chushicode = 1; drawiniz(chushicode); a_context.fillStyle = Backgd3; a_context.fillRect(bianw + 2, 7 * delta + bianh + 2, 24 * delta - 2, 6 * delta - 2); a_context.font = "bold " + 1 * delta / 2 + "px 仿宋_GB2312"; a_context.fillStyle = Foregd; a_context.fillText(rule_name, bianw + delta / 8, bianh + 7 * delta + delta / 4); var number = rule_n; if (number > 35) number = 35; for (var i = 0; i < number; i += 1)drawrulei(i, 0); drawbelt(); } function drawrule1() { yanshi = 1; inistate = "q1"; rule_n = rule1_n; rule_name = rule1_name; rule_1 = rule1_1; rule_2 = rule1_2; rule_3 = rule1_3; rule_4 = rule1_4; rule_5 = rule1_5; drawrule(); } function drawrule2() { yanshi = 2; inistate = "q1"; rule_n = rule5_n; rule_name = rule5_name; rule_1 = rule5_1; rule_2 = rule5_2; rule_3 = rule5_3; rule_4 = rule5_4; rule_5 = rule5_5; drawrule(); } function drawrule3() { yanshi = 3; inistate = "qa"; if (yanshi3 == 2) { rule_n = rule3_n; rule_name = rule3_name; rule_1 = rule3_1; rule_2 = rule3_2; rule_3 = rule3_3; rule_4 = rule3_4; rule_5 = rule3_5; yanshi3 = 1; } else if (yanshi3 == 1) { rule_n = rule7_n; rule_name = rule7_name; rule_1 = rule7_1; rule_2 = rule7_2; rule_3 = rule7_3; rule_4 = rule7_4; rule_5 = rule7_5; yanshi3 = 2; } drawrule(); } function drawrule4() { yanshi = 4; inistate = "q1"; rule_n = rule4_n; rule_name = rule4_name; rule_1 = rule4_1; rule_2 = rule4_2; rule_3 = rule4_3; rule_4 = rule4_4; rule_5 = rule4_5; drawrule(); } function getrule() { var ret = -1; for (var i = 0; i < rule_n; i += 1) { if (rule_2[i] == state && (rule_1[i] == cell[pointcell] || rule_1[i] == "B" && cell[pointcell] == "")) ret = i; } return ret; } function gonext() { var crule = getrule(); if (crule > -1) { resethead(); drawrulei(crule, 0); cell[pointcell] = rule_3[crule]; if (rule_3[crule] == "B") cell[pointcell] = ""; state = rule_4[crule]; if (rule_5[crule] == "R") pointcell++; else if (rule_5[crule] == "L") pointcell--; drawbelt(); var crule = getrule(); if (crule > -1) drawrulei(crule, 1); } else if (zdzt) { zdmingl = false; zdzt = false; a_drawimage(bianw + 22 * delta, 6 * delta + bianh - 4, 2); } var lcell = Math.floor(lbx / delta); var rcell = lcell + 24; if (pointcell - lcell < 3) { zdzt = false; repeat = 8; toright(); } if (rcell - pointcell < 3) { zdzt = false; repeat = 8; toleft(); } } function toleft() { resethead(); lbx += dx; rbx = lbx + 24 * delta + 2 * bianw; drawbelt(); repeat--; if (repeat < 1 && zdmingl) { zdzt = true; tozd(); } else if (repeat > 0) setTimeout("toleft()", timedelta); } function toright() { resethead(); lbx -= dx; rbx = lbx + 24 * delta + 2 * bianw; drawbelt(); repeat--; if (repeat < 1 && zdmingl) { zdzt = true; tozd(); } else if (repeat > 0) setTimeout("toright()", timedelta); } function tobegin() { var crule = getrule(); if (crule > -1) { drawrulei(crule, 0); } drawiniz(chushicode); } function tozd() { if (zdzt && zdmingl) { gonext(); setTimeout("tozd()", timedelta); } }

    </script>

</head>

<body background="" bgColor=#c3cac4 onload="ini();">

    <table bgcolor=#c3cac4
        style=" border: 3 outset #555555; position:absolute;  top:0px; left:0px; height: 560; width: 1000; ">
        <td><canvas id=a name="a" width=1000 height=560></canvas>
        </td>
    </table>

</body>

</html>